<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> tocPDF | Kalman Joseph Szenes </title> <meta name="author" content="Kalman Joseph Szenes"> <meta name="description" content="CLI tool for generating missing PDF outline based on the Table of Contents from the PDF."> <meta name="keywords" content="dmrg, vim, cpp, c++, quantum-chemistry"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kszenes.github.io/projects/tocPDF/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kalman</span> Joseph Szenes </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/ressources/">Ressources (WIP) </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">tocPDF</h1> <p class="post-description">CLI tool for generating missing PDF outline based on the Table of Contents from the PDF.</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>Imagine this: you just became fascinated by some new topic in quantum physics, say, for instance, perturbation theory, and you found that the reference textbook that everyone recommends can be luckily downloaded as a free PDF from the internet. Excited to start your journey in this field, you open the PDF and find a nicely structured table of contents (ToC) with all the relevant subjects having their own dedicated section. Having found the section that you want to start reading, you are eager to jump to it. But wait! For some reason, the outline that comes with the PDF is empty and, therefore, you need to manually navigate to page using the page number from the ToC. Even worse, since the PDF contains a Preface chapter, the page numbering of the book only starts on the PDF page 42 and, therefore, you cannot simply use the PDF page to jump the desired section. Instead, you need to add an offset to the PDF page which makes navigating the PDF even less convenient.</p> <h1 id="solution">Solution</h1> <p>Not to worry, I wrote a Python command line tool <code class="language-plaintext highlighter-rouge">tocPDF</code> to solve precisely this issue. It extracts the ToC found in the PDF and populates the outline of the PDF with it.</p> <figure> <video src="/assets/video/projects/tocPDF-example-video.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls="" loop="" muted=""></video> </figure> <h2 id="installation">Installation</h2> <p>The project is hosted on <a href="github.com/kszenes/tocPDF">GitHub</a> and can be installed using <code class="language-plaintext highlighter-rouge">pip</code>:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>tocPDF
</code></pre></div></div> <h2 id="usage">Usage</h2> <p><code class="language-plaintext highlighter-rouge">tocPDF</code> requires the PDF page number corresponding to the start and end of the ToC as well as the offset to the first page of the book (the first one numbered with an Arabic numeral).</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">--start</span> 3 <span class="nt">--end</span> 6 <span class="nt">--offset</span> 9 example.pdf
tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 example.pdf
</code></pre></div></div> <p>For certain PDFs, this offset is not constant for the entire document due to additional unnumbered or missing pages. This is particularly common between different parts of a textbook where a blank unnumbered page is often added. In these cases, using naively the original offset without taking into account this additional shift would lead to a mismatch between the page number in the outline and the true page number of the section. <code class="language-plaintext highlighter-rouge">tocPDF</code> can address this issue by verifying that the offset for each section is still accurate. This is done by ensuring that the expected page number of a section matches the one parsed from the PDF. This feature can be enabled by passing the <code class="language-plaintext highlighter-rouge">-m/--missing_pages</code> flag:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 <span class="nt">-m</span> example.pdf
</code></pre></div></div> <p>Note that this additional verification step will slow down the generation of the outline.</p> <h2 id="toc-extraction">ToC Extraction</h2> <p><code class="language-plaintext highlighter-rouge">tocPDF</code> works with a number of backends for extracting the ToC from the PDF:</p> <ul> <li> <a href="https://github.com/jsvine/pdfplumber" rel="external nofollow noopener" target="_blank">pdfplumber</a> (default)</li> <li><a href="https://github.com/py-pdf/pypdf" rel="external nofollow noopener" target="_blank">pypdf</a></li> <li> <a href="https://github.com/chrismattmann/tika-python" rel="external nofollow noopener" target="_blank">tika</a> (requires Java)</li> </ul> <p>These can be selected using the <code class="language-plaintext highlighter-rouge">-p/--parser</code> flag:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 <span class="nt">-m</span> <span class="nt">-p</span> pypdf example.pdf
</code></pre></div></div> <p>Certain parsers might perform better than others on certain PDF ToC formats. Therefore, if you are not happy with the results, make sure to experiment with the different parsers.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2024 Kalman Joseph Szenes. Last updated: October 21, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>