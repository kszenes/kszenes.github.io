<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>tocPDF | Kalman Joseph Szenes</title> <meta name="author" content="Kalman Joseph Szenes"> <meta name="description" content="Automatic CLI tool for generating an outline of PDFs based on the its table of contents."> <meta name="keywords" content="dmrg, tensor-networks"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kszenes.github.io/projects/tocPDF/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Kalman </span>Joseph Szenes</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/ressources/">Ressources</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">tocPDF</h1> <p class="post-description">Automatic CLI tool for generating an outline of PDFs based on the its table of contents.</p> </header> <article> <h1 id="problem-statement">Problem statement</h1> <p>Imagine this: you just became fascinated by some new topic in quantum physics, say for instance, perturbation theory and you found that the reference textbook that everyone recommends can be luckily downloaded as a free PDF from the internet. Excited to start you journey in this field you open the PDF and find a nicely structured table of contents (TOC) with all the relevant subjects having there own section. Having found the section that you want to start reading from, you are eager to jump to it. But wait! For some reason, the outline that comes with the PDF is empty and therefore you need to manually navigate to the sections of interest using the (TOC). Even worse, since the PDF contains a Preface chapter meaning that the page numbering of the book only starts on the PDF page 42 and, therefore, you cannot simply use the PDF page to jump to the section. Instead, you need to add an offset to the PDF page which makes navigating the PDF even less convenient.</p> <h1 id="the-solution">The solution</h1> <p>Not to worry, I wrote a Python command line tool <code class="language-plaintext highlighter-rouge">tocPDF</code> to solve precisely this issue. It extracts the TOC found in the PDF and populates the outline of the PDF with it.</p> <h2 id="installation">Installation</h2> <p>The project is hosted on GitHub <a href="github.com/kszenes/tocPDF">tocPDF</a> and can be installed using <code class="language-plaintext highlighter-rouge">pip</code>:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>tocPDF
</code></pre></div></div> <h2 id="usage">Usage</h2> <p><code class="language-plaintext highlighter-rouge">tocPDF</code> requires the page corresponding to the PDF page number corresponding to the start and end of the TOC as well as the offset to the first page of the book (the first one numbered with an Arabic numeral).</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">--start</span> 3 <span class="nt">--end</span> 6 <span class="nt">--offset</span> 9 example.pdf
tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 example.pdf
</code></pre></div></div> <p>For certain PDFs, this offset is not constant for the entire document due to additional unnumbered or missing pages. This is particularly common between different chapters of a textbook where a blank unnumbered page is often added.In these cases, using naively the original offset without taking into account this additional shift would lead to a mismatch between the page number in the outline and the true page number of the section. <code class="language-plaintext highlighter-rouge">tocPDF</code> addresses this issue by verifying that the offset for each section is still accurate. This is done by ensuring that the expected page number of a section matches the one parsed from the PDF. This feature can be enabled by passing the <code class="language-plaintext highlighter-rouge">-m/--missing_pages</code> flag:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 <span class="nt">-m</span> example.pdf
</code></pre></div></div> <p>Note that this additional verification will slow down the generation of the outline.</p> <h2 id="toc-extraction">TOC Extraction</h2> <p><code class="language-plaintext highlighter-rouge">tocPDF</code> works with a number of backends for extraction of the TOC from the PDF:</p> <ul> <li> <a href="https://github.com/jsvine/pdfplumber" rel="external nofollow noopener" target="_blank">pdfplumber</a> (default)</li> <li><a href="https://github.com/py-pdf/pypdf" rel="external nofollow noopener" target="_blank">pypdf</a></li> <li> <a href="https://github.com/chrismattmann/tika-python" rel="external nofollow noopener" target="_blank">tika</a> (requires Java)</li> </ul> <p>These can be selected using the <code class="language-plaintext highlighter-rouge">-p/--parser</code> flag:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tocPDF <span class="nt">-s</span> 3 <span class="nt">-e</span> 6 <span class="nt">-o</span> 9 <span class="nt">-m</span> <span class="nt">-p</span> pypdf example.pdf
</code></pre></div></div> <p>Certain parsers might perform better on certain PDF TOC formats. Therefore, if you are not happy with the results, make sure to try running <code class="language-plaintext highlighter-rouge">tocPDF</code> with different parsers.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Kalman Joseph Szenes. <a href="https://kszenes.github.ioA%20simple,%20whitespace%20theme%20for%20academics.%20Based%20on%20[*folio](https://github.com/bogoli/-folio)%20design.">Impressum</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>